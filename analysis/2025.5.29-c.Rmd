---
title: "2025.5.29-c: Project-2. Activity-based RNA profiling"
output: html_document
---


## Samples

<div style="font-size: 0.8em;">
| #  | Treated on   | Treatment                 | Incubation            | RT ion     | Index        | i5       | i7       |
|----|--------------|---------------------------|-----------------------|------------|--------------|----------|----------|
| 52 | Purified RNA | Ctrl (10% DMSO)           | 37°C for 30min on RNA | Mg2+ (3mM) | i5-7 + i7-1  | AAGGAGTA | TCGCCTTA |
| 53 | Purified RNA | Ctrl (10% DMSO)           | 37°C for 30min on RNA | Mg2+ (3mM) | i5-7 + i7-2  | AAGGAGTA | CTAGTACG |
| 54 | Purified RNA | Ctrl (10% DMSO)           | 37°C for 30min on RNA | Mg2+ (3mM) | i5-7 + i7-3  | AAGGAGTA | TTCTGCCT |
| 55 | Purified RNA | Ctrl (10% DMSO)           | 37°C for 30min on RNA | Mn2+ (3mM) | i5-7 + i7-4  | AAGGAGTA | GCTCAGGA |
| 56 | Purified RNA | Ctrl (10% DMSO)           | 37°C for 30min on RNA | Mn2+ (3mM) | i5-7 + i7-5  | AAGGAGTA | AGGAGTCC |
| 57 | Purified RNA | Ctrl (10% DMSO)           | 37°C for 30min on RNA | Mn2+ (3mM) | i5-7 + i7-6  | AAGGAGTA | CATGCCTA |
| 58 | Purified RNA | Ctrl (10% DMSO)           | 37°C for 2h on RNA    | Mg2+ (3mM) | i5-7 + i7-7  | AAGGAGTA | GTAGAGAG |
| 59 | Purified RNA | Ctrl (10% DMSO)           | 37°C for 2h on RNA    | Mg2+ (3mM) | i5-7 + i7-8  | AAGGAGTA | CCTCTCTG |
| 60 | Purified RNA | Ctrl (10% DMSO)           | 37°C for 2h on RNA    | Mg2+ (3mM) | i5-7 + i7-9  | AAGGAGTA | AGCGTAGC |
| 61 | Purified RNA | Ctrl (10% DMSO)           | 37°C for 2h on RNA    | Mn2+ (3mM) | i5-7 + i7-10 | AAGGAGTA | CAGCCTCG |
| 62 | Purified RNA | Ctrl (10% DMSO)           | 37°C for 2h on RNA    | Mn2+ (3mM) | i5-7 + i7-11 | AAGGAGTA | TGCCTCTT |
| 63 | Purified RNA | Ctrl (10% DMSO)           | 37°C for 2h on RNA    | Mn2+ (3mM) | i5-7 + i7-12 | AAGGAGTA | TCCTCTAC |
| 64 | Purified RNA | C34-NM (1mM final)        | 37°C for 2h on RNA    | Mn2+ (3mM) | i5-8 + i7-1  | CTAAGCCT | TCGCCTTA |
| 65 | Purified RNA | C34-NM (1mM final)        | 37°C for 2h on RNA    | Mn2+ (3mM) | i5-8 + i7-2  | CTAAGCCT | CTAGTACG |
| 66 | Purified RNA | C34-NM (1mM final)        | 37°C for 2h on RNA    | Mn2+ (3mM) | i5-8 + i7-3  | CTAAGCCT | TTCTGCCT |
| 67 | Purified RNA | NM-only (1mM final)       | 37°C for 2h on RNA    | Mn2+ (3mM) | i5-8 + i7-4  | CTAAGCCT | GCTCAGGA |
| 68 | Purified RNA | NM-only (1mM final)       | 37°C for 2h on RNA    | Mn2+ (3mM) | i5-8 + i7-5  | CTAAGCCT | AGGAGTCC |
| 69 | Purified RNA | NM-only (1mM final)       | 37°C for 2h on RNA    | Mn2+ (3mM) | i5-8 + i7-6  | CTAAGCCT | CATGCCTA |
| 70 | Purified RNA | C34-Squarate (1mM final)  | 37°C for 30min on RNA | Mn2+ (3mM) | i5-8 + i7-7  | CTAAGCCT | GTAGAGAG |
| 71 | Purified RNA | C34-Squarate (1mM final)  | 37°C for 30min on RNA | Mn2+ (3mM) | i5-8 + i7-8  | CTAAGCCT | CCTCTCTG |
| 72 | Purified RNA | C34-Squarate (1mM final)  | 37°C for 30min on RNA | Mn2+ (3mM) | i5-8 + i7-9  | CTAAGCCT | AGCGTAGC |
| 73 | Purified RNA | Squarate-only (1mM final) | 37°C for 30min on RNA | Mn2+ (3mM) | i5-8 + i7-10 | CTAAGCCT | CAGCCTCG |
| 74 | Purified RNA | Squarate-only (1mM final) | 37°C for 30min on RNA | Mn2+ (3mM) | i5-8 + i7-11 | CTAAGCCT | TGCCTCTT |
| 75 | Purified RNA | Squarate-only (1mM final) | 37°C for 30min on RNA | Mn2+ (3mM) | i5-8 + i7-12 | CTAAGCCT | TCCTCTAC |
</div>
<br>

- Experiment details: [cDNA preparation](https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/files/2025.5.29/2025.5.1-19 cDNA preparation.pdf)
- Experiment details: [Library construction](https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/files/2025.5.29/2025.5.20 Amplicon library-1.pdf)
- Sequenced with [AVITI Low Output 2 x 150](https://www.elementbiosciences.com/products/aviti/specs) (250M)


## Reference sequences

- [Amplicon-short-trimmed+3.fa](https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/files/2025.5.29/project-1_bwa+filter/Amplicon-short-trimmed+3.fa)  
```{r,eval=FALSE}
>SARS-CoV2-5UTR-Amplicon-short-trimmed+3  (249 bp)
TTGtagatctgttctctaaacgaactttaaaatctgtgtggctgtcactcggctgcgtgcttagtgcactcacgcagtat
aattaataactaattactgtcgttgacaggacacgagtaactcgtctatcttctgcaggctgcttacggtttcgtccgtg
ttgcagccgatcatcagcacatctaggtttcgtccgggtgtgaccgaaaggtaagatggagagccttgtccctggtttca
acgaggGAG
```

- **Prepare reference sequences with ** [```1.refseq.sh```](https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/files/2025.5.28/1.SL5_full_length_refseq/1.refseq.sh)


## FastQC for reads

- **FastQC with ** [```2.fastqc.sh```](https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/files/2025.5.28/1.SL5_full_length_refseq/2.fastqc.sh)  

- Sample-7_R1 (representative FastQC per base quality plot before reads trimming):  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/1.fastqc/07-SL5-DMSO-80C-15min-Mg_R1_001_fastqc_per_base_quality.png" width="80%">
- Sample-7_R2 (representative FastQC per base quality plot before reads trimming):  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/1.fastqc/07-SL5-DMSO-80C-15min-Mg_R2_001_fastqc_per_base_quality.png" width="80%">

<details>
<summary>View all samples before reads trimming:</summary>

- Sample-8_R1:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/1.fastqc/08-SL5-DMSO-80C-15min-Mn_R1_001_fastqc_per_base_quality.png" width="80%">
- Sample-8_R2:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/1.fastqc/08-SL5-DMSO-80C-15min-Mn_R2_001_fastqc_per_base_quality.png" width="80%">

- Sample-9_R1:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/1.fastqc/09-SL5-C12-5mM-80C-15min-Mn_R1_001_fastqc_per_base_quality.png" width="80%">
- Sample-9_R2:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/1.fastqc/09-SL5-C12-5mM-80C-15min-Mn_R2_001_fastqc_per_base_quality.png" width="80%">

- Sample-10_R1:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/1.fastqc/10-SL5-C15-5mM-80C-15min-Mn_R1_001_fastqc_per_base_quality.png" width="80%">
- Sample-10_R2:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/1.fastqc/10-SL5-C15-5mM-80C-15min-Mn_R2_001_fastqc_per_base_quality.png" width="80%">

- Sample-11_R1:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/1.fastqc/11-SL5-C12-500uM-80C-15min-Mn_R1_001_fastqc_per_base_quality.png" width="80%">
- Sample-11_R2:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/1.fastqc/11-SL5-C12-500uM-80C-15min-Mn_R2_001_fastqc_per_base_quality.png" width="80%">

- Sample-12_R1:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/1.fastqc/12-SL5-C15-500uM-80C-15min-Mn_R1_001_fastqc_per_base_quality.png" width="80%">
- Sample-12_R2:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/1.fastqc/12-SL5-C15-500uM-80C-15min-Mn_R2_001_fastqc_per_base_quality.png" width="80%">

</details>

- **Conclusion**: within 150bp, the reads quality is generally good. R2 has lower overall quality than R1, which is expected for paired-end reads.


## Reads trimming

- **Reads trimming with ** [```3.trim.sh```](https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/files/2025.5.28/1.SL5_full_length_refseq/3.trim.sh)  

- Key filtering standards:  
```{r,eval=FALSE}
1.Keeping the first 200bp and discard the tail
2.Trimming the tail with average Q-score < 20 (4 bases moving window size)
3.Discarding reads with more than 10% of Q-score < 20 bases
```


## FastQC for reads after trimming

- **Re-FastQC with ** [```4.refastqc.sh```](https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/files/2025.5.28/1.SL5_full_length_refseq/4.refastqc.sh)  

- Sample-7_R1 (representative FastQC per base quality plot after reads trimming): 
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/2.refastqc/07-SL5-DMSO-80C-15min-Mg_001_R1.trimmed_fastqc_per_base_quality.png" width="80%">
- Sample-7_R2 (representative FastQC per base quality plot after reads trimming): 
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/2.refastqc/07-SL5-DMSO-80C-15min-Mg_001_R2.trimmed_fastqc_per_base_quality.png" width="80%">

<details>
<summary>View all samples after after trimming:</summary>

- Sample-8_R1:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/2.refastqc/08-SL5-DMSO-80C-15min-Mn_001_R1.trimmed_fastqc_per_base_quality.png" width="80%">
- Sample-8_R2:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/2.refastqc/08-SL5-DMSO-80C-15min-Mn_001_R2.trimmed_fastqc_per_base_quality.png" width="80%">

- Sample-9_R1:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/2.refastqc/09-SL5-C12-5mM-80C-15min-Mn_001_R1.trimmed_fastqc_per_base_quality.png" width="80%">
- Sample-9_R2:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/2.refastqc/09-SL5-C12-5mM-80C-15min-Mn_001_R2.trimmed_fastqc_per_base_quality.png" width="80%">

- Sample-10_R1:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/2.refastqc/10-SL5-C15-5mM-80C-15min-Mn_001_R1.trimmed_fastqc_per_base_quality.png" width="80%">
- Sample-10_R2:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/2.refastqc/10-SL5-C15-5mM-80C-15min-Mn_001_R2.trimmed_fastqc_per_base_quality.png" width="80%">

- Sample-11_R1:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/2.refastqc/11-SL5-C12-500uM-80C-15min-Mn_001_R1.trimmed_fastqc_per_base_quality.png" width="80%">
- Sample-11_R2:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/2.refastqc/11-SL5-C12-500uM-80C-15min-Mn_001_R2.trimmed_fastqc_per_base_quality.png" width="80%">

- Sample-12_R1:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/2.refastqc/12-SL5-C15-500uM-80C-15min-Mn_001_R1.trimmed_fastqc_per_base_quality.png" width="80%">
- Sample-12_R2:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/2.refastqc/12-SL5-C15-500uM-80C-15min-Mn_001_R2.trimmed_fastqc_per_base_quality.png" width="80%">

</details>

- **Conclusion**: after trimming, the quality of the overall reads quality is improved and variation is reduced.


## Reads mapping

- **Reads mapping with ** [```5.bam.sh```](https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/files/2025.5.28/1.SL5_full_length_refseq/5.bam.sh)  


## Analyzing and visualization

- **Pileup with ** [```6.mpileup.sh```](https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/files/2025.5.28/1.SL5_full_length_refseq/6.mpileup.sh)  
- **Parse with ** [```7.parse.R```](https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/files/2025.5.28/1.SL5_full_length_refseq/7.parse.R)  
- For parsed mutation rate spreadsheets, click [here](https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/files/2025.5.28/1.SL5_full_length_refseq/mpileup_parse.zip).
- **Plot with ** [```8.plot.R```](https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/files/2025.5.28/1.SL5_full_length_refseq/8.plot.R)  

### Absolute mutation rate (after reads trimming)

<details>
<summary>Absolute mutation rate:</summary>

- Sample-7:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/3.absolute_mut/07-SL5-DMSO-80C-15min-Mg-001_SARS-CoV2-5UTR-Amplicon.jpg" width="100%">

- Sample-8:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/3.absolute_mut/08-SL5-DMSO-80C-15min-Mn-001_SARS-CoV2-5UTR-Amplicon.jpg" width="100%">

- Sample-9:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/3.absolute_mut/09-SL5-C12-5mM-80C-15min-Mn-001_SARS-CoV2-5UTR-Amplicon.jpg" width="100%">

- Sample-10:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/3.absolute_mut/10-SL5-C15-5mM-80C-15min-Mn-001_SARS-CoV2-5UTR-Amplicon.jpg" width="100%">

- Sample-11:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/3.absolute_mut/11-SL5-C12-500uM-80C-15min-Mn-001_SARS-CoV2-5UTR-Amplicon.jpg" width="100%">

- Sample-12:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/3.absolute_mut/12-SL5-C15-500uM-80C-15min-Mn-001_SARS-CoV2-5UTR-Amplicon.jpg" width="100%">

</details>

### Relative mutation rate (after reads trimming)

<details>
<summary>Relative mutation rate:</summary>

- Sample-7:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/4.relative_mut/07-SL5-DMSO-80C-15min-Mg-001_SARS-CoV2-5UTR-Amplicon.jpg" width="100%">

- Sample-8:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/4.relative_mut/08-SL5-DMSO-80C-15min-Mn-001_SARS-CoV2-5UTR-Amplicon.jpg" width="100%">

- Sample-9:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/4.relative_mut/09-SL5-C12-5mM-80C-15min-Mn-001_SARS-CoV2-5UTR-Amplicon.jpg" width="100%">

- Sample-10:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/4.relative_mut/10-SL5-C15-5mM-80C-15min-Mn-001_SARS-CoV2-5UTR-Amplicon.jpg" width="100%">

- Sample-11:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/4.relative_mut/11-SL5-C12-500uM-80C-15min-Mn-001_SARS-CoV2-5UTR-Amplicon.jpg" width="100%">

- Sample-12:  
<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/4.relative_mut/12-SL5-C15-500uM-80C-15min-Mn-001_SARS-CoV2-5UTR-Amplicon.jpg" width="100%">

</details>

### Base Summary

- All samples:  

<img src="https://raw.githubusercontent.com/chenh19/chemProbing/refs/heads/main/images/2025.5.28/1.SL5_full_length_refseq/5.base_summary/base_summary_80C.jpg" width="70%">

- **Conclusion**: Overall result is consistent with [previous experiment](https://chenh19.github.io/chemProbing/2025.5.27-a.html#base-summary). 
